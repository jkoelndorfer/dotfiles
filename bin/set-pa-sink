#!/bin/bash

function get_full_sink_name {
    all_sinks="$(pacmd list-sinks | grep 'name:' | awk '{ print $2 }' | sed -r -e 's/<|>//g')"
    for filter in "$@"; do
        all_sinks="$(echo "$all_sinks" | grep -i -E "$filter")"
    done
    echo "$all_sinks" | head -n 1
}

sink_name="$(get_full_sink_name "$@")"

if [[ -z "$sink_name" ]]; then
    echo "Couldn't find sink matching filters: $@" >&2
    exit 1
fi
pacmd set-default-sink "$sink_name"
pacmd list-sink-inputs | grep 'index:' | awk '{ print $2 }' | while read app_index; do
    pacmd move-sink-input "$app_index" "$sink_name"
done
