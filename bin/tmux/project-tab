#!/bin/zsh

source "$ZSH_LIB_DIR/misc.zsh"
dir=$(selectdir)

if [[ -z "$dir" ]]; then
    # The user probably canceled selectdir.
    exit 1
fi

cd "$dir"

# TMUX_PROJECT_TAB Indicates that applications are running
# in a project tab.
#
# This is a useful signal for vim. Because quitting vim
# would cause the project tab to be "busted" without
# an editor, vim will automatically restart if running
# in a project tab.
tmux new-window -e TMUX_PROJECT_TAB=1 nvim \; \
     rename-window "$(basename "$dir")" \; \
     split-window -v \; \
     resize-pane -y '30%' \; \
     split-window -h \; \
     select-pane -t '{top}'
