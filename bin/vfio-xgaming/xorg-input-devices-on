#!/bin/bash

# This script switches Xorg input devices to the given display.

desired_display="$1"
if ! DISPLAY="$desired_display" xinput --list >/dev/null 2>&1; then
    echo "Xorg display $desired_display does not appear to be active; doing nothing." >&2
    exit 1
fi

if [[ "$desired_display" == "$PRIMARY_DISPLAY" ]]; then
    other_display="$GAMING_DISPLAY"
elif [[ "$desired_display" == "$GAMING_DISPLAY" ]]; then
    other_display="$PRIMARY_DISPLAY"
else
    echo "Unsure how to proceed with display $desired_display!" >&2
    echo 'Cowardly aborting.' >&2
    exit 2
fi

script_dir=$(dirname "$0")

DISPLAY="$desired_display" "$script_dir/xorg-device-state" enable "$X11_KEYBOARD_DEVICE"
DISPLAY="$desired_display" "$script_dir/xorg-device-state" enable "$X11_MOUSE_DEVICE"

DISPLAY="$other_display" "$script_dir/xorg-device-state" disable "$X11_KEYBOARD_DEVICE"
DISPLAY="$other_display" "$script_dir/xorg-device-state" disable "$X11_MOUSE_DEVICE"
